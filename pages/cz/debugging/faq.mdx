# FAQ

**Otázka:** Každý Pod, Job, Deployment a jakýkoli jiný typ, který spouští kontejner, musí mít nastaven atribut *resources*, jinak nasazení selže s podobnou chybou:
```
Pods "master-685f855ff-gg9sr" is forbidden: failed quota: default-w2qv7: must specify limits.cpu,limits.memory,requests.cpu,requests.memory:Deployment does not have minimum availability.
```

**Odpověď:** Pod, Job, Deployment postrádá následující sekci zdrojů s odpovídajícími hodnotami:
```yaml
resources:
  requests:
    cpu: 1
    memory: 512Mi
  limits:
    cpu: 1
    memory: 512Mi

```

---

**Otázka:** Deployment vrací zprávu podobnou:
```log
pods cz-iocb-nextprot-loader-loaderspark-1649322652207-driver" is forbidden: 
exceeded quota: default-sq5kt, requested: limits.cpu=1,limits.memory=2432Mi,requests.cpu=1,requests.memory=2432Mi, 
used: limits.cpu=0,limits.memory=0,requests.cpu=0,requests.memory=0,
limited:limits.cpu=0,limits.memory=0,requests.cpu=0,requests.memory=0.
```

**Odpověď:** Nasazení se provádí do *Namespace*, která má nedostatek kvót nebo má kvótu nastavenu na nulu. Musíte zvýšit kvótu *Namespace*, což může vyžadovat snížení kvót vašich dalších *Namespaces* nebo požádat o explicitní *Projekt*. Viz [Projekty, Namespaces a Kvóty](../rancher/quotas).

---

**Otázka:** Žádný GPU nebyl nalezen, `nvidia-smi` vrací `command not found`.

**Odpověď:** Nasazení postrádá požadavek na GPU jako:

```yaml
resources:
  limits:
    nvidia.com/gpu: 1
```

nebo

```yaml
resources:   
  limits:
    cerit.io/gpu-mem: 1
```

---

**Otázka:** Nasazení vrací zprávu podobnou:

```log
CreateContainerConfigError (container has runAsNonRoot and image will run as root (pod: "mongo-db-846b7bfc7-qrlqt_namespace-ns(5d3538ab-7493-41ab-bd94-a4256c236f6f)", container: mongo-db-test))
```

**Odpověď:** Nasazení postrádá sekci `securityContext` a obraz kontejneru (v tomto případě `mongo`) neobsahuje **číselný** `USER`. Chcete-li to opravit, jednoduše rozšiřte definici nasazení takto:
```yaml
image: cerit.io/nextflowproxy:v1.2
imagePullPolicy: Always
securityContext:
  runAsUser: 1000
  runAsGroup: 1000
resources:
  limits:
    cpu: 4
    memory: 8192Mi
```

Řádky `runAsUser` a `runAsGroup` jsou důležité.

**Viz úplné nastavení kontextu zabezpečení** [zde](../kubernetes/securitycontext).

---

**Otázka:** Helm nasazení vrací chybový kód 413

**Odpověď:** HTML kód 413 znamená, že entita je příliš velká. Helm ukládá celé nasazení (včetně všech místních souborů v chartu, bez ohledu na to, zda mají příponu `.yaml`) a hodnoty do objektu `Secret`. Limit velikosti Secret je přibližně 1,5 MB. Ověřte, zda v celém chartu není žádný velký soubor.
