# Logging

Logging v Kubernetes clusteru je zajišťováno [Logging operátorem](https://kube-logging.dev/). Tento nástroj umožňuje vytváření přizpůsobených loggingových pipeline, které splňují požadavky uživatelů.

Loggingová pipeline se skládá ze dvou komponent, `SyslogNGFlow` a `SyslogNGOutput`. `SyslogNGFlow` specifikuje výběr logů a filtry logů. `SyslogNGOutput` specifikuje výstupní destinaci logů.

## SyslogNGFlow

`SyslogNGFlow` specifikuje, jaké logy by měly být odeslány do konečné výstupní destinace. K tomu používá `match` příkazy, které podporují logické operátory `and`, `or` a `not`. `SyslogNGFlow` musí mít alespoň jeden `match` příkaz pro přenos logů.

### Example
Můžete použít níže uvedenou příkladovou konfiguraci k shromažďování všech logů podů z určitého namespace. Specifikujte namespace a název souvisejícího zdroje `SyslogNGOutput`.

```yaml
apiVersion: logging.banzaicloud.io/v1beta1
kind: SyslogNGFlow
metadata:
  name: syslog-flow
  namespace: [your_namespace]
spec:
  match:
    regexp:
      value: json.kubernetes.labels.app.kubernetes.io/instance
      pattern: "*"
      type: glob
  localOutputRefs:
    - [output_resource_name]
```

Pokud související Logging zdroj specifikuje hodnotu `loggingRef`, přidejte to do specifikace `SyslogNGFlow`.
```yaml
spec:
  loggingRef: [value]
```

Pro zobrazení všech možností směrování se podívejte na [oficiální dokumentaci](https://kube-logging.dev/docs/configuration/log-routing-syslog-ng/).

## SyslogNGOutput

`SyslogNGOutput` konfiguruje výstupní destinaci logů. `SyslogNGOutput` může konfigurovat pouze jeden výstupní plugin v rámci specifikace.

### Example
Můžete použít níže uvedenou příkladovou konfiguraci k přenosu logů pomocí Syslog protokolu. Specifikujte název zdroje, namespace, IP adresu a port. Ujistěte se, že používáte stejné jméno jako v `localOutputRefs`.

```yaml
apiVersion: logging.banzaicloud.io/v1beta1
kind: SyslogNGOutput
metadata:
  name: [output_resource_name]
  namespace: [your_namespace]
spec:
  syslog:
      host: [ip_address]
      port: [port]
```

Pokud související Logging zdroj specifikuje hodnotu `loggingRef`, přidejte to do specifikace `SyslogNGFlow`.
```yaml
spec:
  loggingRef: [value]
```

Pro zobrazení kompletního seznamu dostupných výstupních pluginů se podívejte na [oficiální dokumentaci](https://kube-logging.dev/docs/configuration/plugins/syslog-ng-outputs/).

## Logging pipeline deployment
Pro vytvoření nové loggingové pipeline aplikujte konfigurace zdrojů z YAML souboru.

    kubectl apply -f [path_to_yaml_file]
