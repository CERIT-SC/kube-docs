# Certifikát

Kubernetes může vydávat a spravovat vlastní důvěryhodné certifikáty pomocí protokolu ACME. Certifikáty jsou uloženy jako tajemství.

To je obzvlášť důležité pro povolení TLS při vystavování ne-webových aplikací, tedy bez Ingress.

V současnosti jsou k dispozici čtyři vydavatelé:
* Vydavatel `letsencrypt-prod` je pouze pro web a automaticky kontroluje web na zadaném doménovém jménu během procesu vydávání. Je automaticky používán při vystavování aplikace prostřednictvím [ingress](expose#web-based-applications).
* Vydavatel `letsencrypt-prod-dns` je určen pro jiné aplikace. Rozdíl je v kontrole dns. Nicméně, kontrola dns je pomalejší, protože změna dns se musí nejprve propagovat.
* `letsencrypt-stage` je stejný jako `letsencrypt-prod`, ale používá stagingové servery vhodné pro testování.
* `letsencrypt-stage-dns` je stejný jako `letsencrypt-prod-dns`, ale používá stagingové servery vhodné pro testování.

Pro vydání certifikátu spravovaného Kubernetes lze použít následující konfiguraci.

```yaml filename="secret.yaml" copy
apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: application-dyn-cloud-e-infra-cz-tls
spec:
  secretName: application-dyn-cloud-e-infra-cz-tls
  issuerRef:
    group: cert-manager.io
    kind: ClusterIssuer
    name: letsencrypt-prod-dns
  dnsNames:
  - "application.dyn.cloud.e-infra.cz"
  usages:
  - digital signature
  - key encipherment
```
Kde `metadata.name`, `spec.secretName` odkazují na název vygenerovaného certifikátu. Položky `spec.dnsNames` jsou cílové dns názvy certifikátu. Vydavatel je specifikován v `spec.issuerRef.name` a měl by být nastaven na `letsencrypt-prod-dns`.

Konfigurace generuje tajemství, specifikované v `spec.secretName`, obsahující certifikát a pár soukromého klíče.
